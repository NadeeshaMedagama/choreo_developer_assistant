openapi: 3.0.3
info:
  title: Choreo AI Assistant API
  description: RAG-based AI Assistant for Choreo documentation and architecture queries
  version: 1.0.0
  contact:
    name: Choreo AI Assistant Support

servers:
  - url: /
    description: Base path

tags:
  - name: Health
    description: Health check and status endpoints
  - name: Query
    description: AI-powered question answering endpoints

paths:
  /:
    get:
      summary: Root endpoint
      description: Returns a welcome message and API status
      tags:
        - Health
      responses:
        '200':
          description: API is running
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  status:
                    type: string

  /health:
    get:
      summary: Basic health check
      description: Returns health status without initializing all services
      tags:
        - Health
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string
                  services_initialized:
                    type: boolean

  /api/health:
    get:
      summary: Detailed health check
      description: Returns detailed health status and initializes services if needed
      tags:
        - Health
      responses:
        '200':
          description: Detailed health information
          content:
            application/json:
              schema:
                type: object

  /metrics:
    get:
      summary: Prometheus metrics
      description: Returns Prometheus-compatible metrics
      tags:
        - Health
      responses:
        '200':
          description: Metrics in Prometheus format
          content:
            text/plain:
              schema:
                type: string

  /api/ask:
    post:
      summary: Ask AI a question
      description: Submit a question to the AI assistant
      tags:
        - Query
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - question
              properties:
                question:
                  type: string
                  description: The question to ask
                conversation_history:
                  type: array
                  description: Previous conversation messages
                  items:
                    type: object
                    properties:
                      role:
                        type: string
                      content:
                        type: string
                summary:
                  type: object
                  description: Conversation summary from previous interactions
                max_history_tokens:
                  type: integer
                  description: Maximum tokens for history
                  default: 4000
                enable_summarization:
                  type: boolean
                  description: Enable/disable auto-summarization
                  default: true
      responses:
        '200':
          description: AI response
          content:
            application/json:
              schema:
                type: object
                properties:
                  answer:
                    type: string
                  sources:
                    type: array
                    items:
                      type: object
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

